<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Linux Privilege Escalation | Mil0</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Linux Privilege Escalation" /><meta name="author" content="Mil0" /><meta property="og:locale" content="en_US" /><meta name="description" content="This post will serve as an introduction to Linux escalation techniques, mainly focusing on file/process permissions, but along with some other stuff too." /><meta property="og:description" content="This post will serve as an introduction to Linux escalation techniques, mainly focusing on file/process permissions, but along with some other stuff too." /><link rel="canonical" href="https://mil0.io/linux-privesc/" /><meta property="og:url" content="https://mil0.io/linux-privesc/" /><meta property="og:site_name" content="Mil0" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-17T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux Privilege Escalation" /><meta name="twitter:site" content="@mil0sec" /><meta name="twitter:creator" content="@Mil0" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"This post will serve as an introduction to Linux escalation techniques, mainly focusing on file/process permissions, but along with some other stuff too.","headline":"Linux Privilege Escalation","dateModified":"2018-09-17T00:00:00+01:00","datePublished":"2018-09-17T00:00:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mil0.io/linux-privesc/"},"url":"https://mil0.io/linux-privesc/","author":{"@type":"Person","name":"Mil0"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/images/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"><div id="logoContainer"><pre class="ascii name">Milo_Sec<span id="blinky">|</span></pre></div></div><div class="site-subtitle font-italic">I like bad movies and all things *sec. Security consultant.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/PercussiveElbow" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/mil0sec" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Linux Privilege Escalation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux Privilege Escalation</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Sep 17, 2018, 12:00 AM +0100" > Sep 17, 2018 <i class="unloaded">2018-09-17T00:00:00+01:00</i> </span> by <span class="author"> Mil0 </span></div></div><div class="post-content"><p>This post will serve as an introduction to Linux escalation techniques, mainly focusing on file/process permissions, but along with some other stuff too.</p><p>You’ve gained some access to a machine and you need that root shell, but you don’t wanna run the risk of crashing the box through running whatever the latest kernel exploit is that Tavis Ormandy released this morning. So what do you do?</p><h2 id="intro-to-file-permissions">Intro to File Permissions</h2><p>On Linux each file is associated with a set of permissions.</p><p>I’m logged in as user I have created for these examples, <code class="language-plaintext highlighter-rouge">low</code>. I’ve created a file with the <code class="language-plaintext highlighter-rouge">touch</code> command, and then simply listed the contents of the directory.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example1.png" alt="Example" /></p><p>Okay, so what does all this information mean? Well, lets work our way from right to left.</p><ul><li>Starting off we obviously have the file name.</li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example2.png" alt="Example" /></p><ul><li>Next we have the date/time the file was last modified, again straightforward.</li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example3.png" alt="Example" /></p><ul><li>Now we have the size of the file. I haven’t added any contents to this file, so it’s empty (0).</li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example4.png" alt="Example" /></p><h3 id="ownership">Ownership</h3><p>Now we’re getting to the important stuff.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example5.png" alt="Example" /></p><p>What this section shows is the is ownership of the file. The value on the left is the user owner, while the right is the group owner.</p><p>Users on Linux can be part of multiple groups. By default you will be in a group of your own username.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example6.png" alt="Example" /></p><p>As a note, to change file user/group ownership we can simply use <code class="language-plaintext highlighter-rouge">chown</code>. The syntax for this is:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chown </span>user:group filename</code></pre></figure><p>If you only need to change the group owner, <code class="language-plaintext highlighter-rouge">changegrp</code> is avaliable.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">chngrp group filename</code></pre></figure><p>If you only need to change the user owner, just use chown without the second half.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chown </span>user filename</code></pre></figure><h3 id="permissions">Permissions</h3><p>Finally let’s look at the leftmost section. These are the permissions.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example7.png" alt="Example" /></p><p>Linux file permissions are divided into three parts</p><ol><li><code class="language-plaintext highlighter-rouge">Read (r)</code></li><li><code class="language-plaintext highlighter-rouge">Write (w)</code></li><li><code class="language-plaintext highlighter-rouge">Execute (x)</code></li></ol><p>If none of the above apply, it will simply be displayed as (-).</p><p>So this section shows us if we have read, write, execute permissions. So why are these three values repeated three times?</p><p>This is because each file has r/w/x permissions associated for it’s <code class="language-plaintext highlighter-rouge">user(u)</code>,<code class="language-plaintext highlighter-rouge">group(g)</code> and finally <code class="language-plaintext highlighter-rouge">other(o)</code>, which is everyone else.</p><p>To set these permissions we have a few options.</p><p>To add individual permissions to a user we can use the following syntax. This command adds execute permissions(x) to the user that owns the file.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chmod </span>u+x filename</code></pre></figure><p>To remove this permission, replace the + with -.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chmod </span>u-x filename</code></pre></figure><p>If you want to edit the read(r) or write(w) permissions, just replace the x value in the above example with the appropriate character. Similarily, if you want to edit the permission for the group(g) or other(o), just replace the u value.</p><p>Alternatively we can do this numerically. Think of each rwx as three binary bits</p><p>e.g. rw- is 110, which is 6 in decimal.</p><p>Using <em>chmod</em> again, we can set the exact rwx permissions for each category (u/g/o) at once. For example to add rw- permissions to user (u), and r- - permissions to group(g) and other(o), use the following command.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chmod </span>644 filename</code></pre></figure><p>To calculate this:</p><p>rw- r– r–</p><p>110 100 100</p><p>6 4 4</p><h3 id="more-permissions">More Permissions</h3><p>The final character on the end will represent whether the item is:</p><ul><li><strong>a file <code class="language-plaintext highlighter-rouge">-</code></strong></li><li><strong>directory <code class="language-plaintext highlighter-rouge">d</code></strong></li><li><strong>symbolic link <code class="language-plaintext highlighter-rouge">l</code></strong></li></ul><p>Meanwhile the presence of a <code class="language-plaintext highlighter-rouge">t</code> indicates a sticky bit. This means only the file owner, the owner of the directory, or root can rename/delete that file.</p><p>There is another type of permission: the SUID/GUID bits. These stand for <em>Set User ID</em> and <em>Set Group ID</em>.</p><p>These bits tell the system to run the executable as either the owner or group owner of the file. They are indicated by an <code class="language-plaintext highlighter-rouge">s</code> in either the user execute permission or group execute permission. This means we can allow another user to run a command as either another user/group, or even root. If we can exploit this we would be able to escalate privileges.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/example8.png" alt="Example" /></p><p>We can set these much like earlier:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chmod </span>u+s filename</code></pre></figure><p>SetUID is usually ignored on files containing shebangs (an example being <code class="language-plaintext highlighter-rouge">#!/bin/bash</code> you often see at the top of a file) for sensible security reasons, so generally it only works with binaries. For this reason you may see binary files acting as wrappers to call shell commands to work around this.</p><p>I’ll discuss the exploitation of these SUID/GUID bits more shortly.</p><h2 id="exploiting-sudo">Exploiting Sudo</h2><p>The sudo command allows us to run a command as another user or root.</p><p>We can check if we’re able to run any commands with sudo for our current user with</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo</span> <span class="nt">-l</span></code></pre></figure><p>This is a <em>very</em> good way to escalate privileges, as it’s a common misconfiguration.</p><p>As an common example of this, my low user has access to sudo a text editor (vim).</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/sudo1.png" alt="Example" /></p><p>Using <code class="language-plaintext highlighter-rouge">sudo vi</code> will allow us to read/write anywhere arbitrarily, but not only that we can even drop down to a shell with <code class="language-plaintext highlighter-rouge">:shell</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/sudo2.png" alt="Example" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/sudo3.png" alt="Example" /></p><p>Many common binaries can be used in similar ways to escape to the shell with higher privileges. A few are listed below.</p><ul><li><em>cp</em>,<em>mv</em>: You can write anywhere, so move or copy over <em>/etc/passwd</em> to add a user (kind of dangerous) or a SSH key.</li><li><em>less</em>,<em>more</em>: Call <code class="language-plaintext highlighter-rouge">!bash</code></li><li><em>man man</em>: Again call <code class="language-plaintext highlighter-rouge">!bash</code></li><li><em>expect</em>: Call <code class="language-plaintext highlighter-rouge">spawn bash</code>, then <code class="language-plaintext highlighter-rouge">bash</code></li><li><em>awk</em>: Run <code class="language-plaintext highlighter-rouge">awk 'BEGIN {system("/bin/sh")}'</code></li><li><em>Text editors</em>: Like vi most of these have shell escapes.</li></ul><p>If you have sudo access to any language interpreter (such as python, perl or ruby), you have a very convenient escalation method, just run whatever code you want with higher privileges.</p><p>If you don’t have sudo access to a language interpreter but you do have access to a language package manager (think Python’s Pip, Ruby’s Bundler, NodeJS’s NPM) etc. you can sudo install a custom package containing your executable code.</p><h2 id="exploiting-suidguid">Exploiting SUID/GUID</h2><p>As we now know, these type of files should be very useful for escalating privileges. Before we can attempt to exploit SUID though we need to find some targets via some quick enumeration.</p><p>To locate SUID files</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null</code></pre></figure><p>To locate GUID files</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">find / <span class="nt">-perm</span> <span class="nt">-g</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null</code></pre></figure><hr /><p>As it’s impossible to list all the types of exploitable executables that could be running under sudo/SUID/GUID, it’s good to know how to enumerate them yourself. This way you know if you can abuse them and hopefully execute code in an unintended manner. To do so you should investigate the behaviour of the executable thoroughly, including researching any “features” that might be able to be exploited. You can do this through checking any extra arguments ( with <code class="language-plaintext highlighter-rouge">program_name -h</code>) or by further research using <code class="language-plaintext highlighter-rouge">man program_name</code>.</p><p>Google is also a solid resource to find more details about a given executable. However if you are dealing with a compiled home-grown application binary or just one with no source code avaliable you may need to reverse engineer it. This is out of scope of this tutorial.</p><p>Now I’ll list some common techniques for exploiting SUID/GUID and sudoable executables to escalate privileges.</p><hr /><h2 id="exploiting-suidguidsudo-with-writable-files">Exploiting SUID/GUID/Sudo with writable files</h2><p>Self explanatory: If a SUID bit is set on a file/file is sudoable while also being world writable or at least writable by our user we can insert whatever code we want into it and use it to escalate privileges when we run it.</p><h2 id="exploiting-suidguidsudo-with-command-injection">Exploiting SUID/GUID/Sudo with Command Injection</h2><p>If we can inject commands on a binary with SUID enabled we can escalate privileges. This is pretty much the same as regular command injection other than the aspect that we’re running code with higher privileges. For this I’m going to use a slightly edited example from <a href="https://www.owasp.org/index.php/Command_Injection">OWASP’s Command Injection Page</a></p><h3 id="example">Example</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_command_injection_1.png" alt="Example" /></p><p>This binary simply calls the system <code class="language-plaintext highlighter-rouge">cat</code> command, but allows us to supply an argument.</p><p>By performing some basic command injection, we can execute the cat command and then another command of our choosing.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_command_injection_2.png" alt="Example" /></p><p>If we get command injection like this in a SUID binary, escalating is easy.</p><h2 id="exploiting-suidguidsudo-with-path">Exploiting SUID/GUID/Sudo with PATH</h2><p>Note: This following technique <em>can</em> work with sudo, but generally sudo is configured in way where your path and environment variables don’t get preserved. If <code class="language-plaintext highlighter-rouge">env_reset</code> is disabled you may be able to exploit this. <a href="https://unixhealthcheck.com/blog?id=363">More Information</a></p><p>Lets say we’ve found a SUID binary. We can see that it’s calling the system shell. In this situation we weren’t able to exploit it by supplying an argument for command injection because our argument doesn’t get passed down to the call to the shell, so what is another method to exploit this?</p><h3 id="example-1">Example</h3><p>This binary calls the system shell with the harmless <code class="language-plaintext highlighter-rouge">id</code> command. One thing that this binary doesn’t do however, is list the full absolute path of <em>id</em> (in this case <code class="language-plaintext highlighter-rouge">/usr/bin/id</code>). This is <em>great</em> for priv esc, because if we have the ability to edit our own path, we can redirect the execution to a binary we supply ourselves. This works for any binary really, id is just an example.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid1.png" alt="Example" /></p><p>I’ve provided the source code above, but in the case we can often identify the command from the binary with <code class="language-plaintext highlighter-rouge">strings filename</code> or some reverse engineering.</p><p>Running the compiled file runs the id command as expected, showing us it is running as root.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid2.png" alt="Example" /></p><p>I quickly make an exploit file and compile it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid5.png" alt="Example" /></p><p>Since the call to id does not list the absolute path. I can exploit this by editing my own path variable to point to another directory. When the shell calls for an executable like <em>id</em>, it looks through all the locations on the PATH and when it obtains the first instance of a file matching the name, it will attempt to run it.</p><p>Therefore by setting my own path to point to the directory I’m currently in first (<code class="language-plaintext highlighter-rouge">/home/low/suid</code>) and then renaming my exploit binary to <em>id</em>, execution can be redirected to the evil <em>id</em> rather than the real one. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid3.png" alt="Example" /></p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/exploit/code/location:<span class="nv">$PATH</span></code></pre></figure><p>As you can see calling the binary runs the evil id and the exploit code within.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid4.png" alt="Example" /></p><p>Running <code class="language-plaintext highlighter-rouge">which id</code> after we edit the path shows us the actual location of the binary that we will run if we call <em>id</em>, this is the evil one.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid6.png" alt="Example" /></p><p>Before editing the path we can see <em>id</em> points to the correct location <code class="language-plaintext highlighter-rouge">/usr/bin/id</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid7.png" alt="Example" /></p><h2 id="exploiting-suidguidsudo-with-environment-variables">Exploiting SUID/GUID/Sudo with Environment Variables</h2><p>This is the same logic as exploiting using the PATH method. Just set the environment variable instead of your path.</p><h2 id="exploiting-suidguidsudo-with-symlinks">Exploiting SUID/GUID/Sudo with Symlinks</h2><p>Let’s say you find a SUID binary. It does some harmless action like <code class="language-plaintext highlighter-rouge">tar</code> ing up a folder. In this situation you’re not able to write to the binary, you can’t inject code, the shell call to the executable has it’s absolute path listed and even environment variable injection won’t seem to work.</p><p>You can however add files to the directory it tars. Note: This method isn’t exclusive to tar, and should work with similar methods like zip, cp -r and so on</p><h3 id="example-2">Example</h3><p>The following example is pretty unlikely and is just for educational purposes, because it relies on the dumb mistake of using the <code class="language-plaintext highlighter-rouge">-h</code> argument on tar. This argument indicates to archive the actual file being referenced by a symlink rather than the symlink itself.</p><p>We found a backup script with SUID set that tars up a folder we own (<em>work_folder</em>), before extracting it with the current timestamp and giving our <em>low</em> user ownership of the extracted directory.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_symlink_1.png" alt="Example" /></p><p>System call looks like this:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">/bin/tar cfh /home/low/suid/symlink_example/backup.tar /home/low/suid/symlink_example/work_folder
<span class="nv">folder</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> +%Y%m%d_%H%M%S<span class="si">)</span>
<span class="nb">mkdir</span> <span class="s2">"</span><span class="nv">$folder</span><span class="s2">"</span>
/bin/tar xf /home/low/suid/symlink_example/backup.tar <span class="nt">-C</span> <span class="s2">"</span><span class="nv">$folder</span><span class="s2">"</span>
<span class="nb">chown </span>low:low <span class="nt">-R</span> <span class="s2">"</span><span class="nv">$folder</span><span class="s2">"</span></code></pre></figure><p>We would like to read a secret file that we don’t have access to within <em>/root</em>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_symlink_2.png" alt="Example" /></p><p>Regular users can still set symlinks to locations they can’t access. So by creating a symlink to <code class="language-plaintext highlighter-rouge">/root</code> called “work_folder” as the low user, we can cause the program to include the contents of /root in the backup instead of whatever files it was supposed to be backing up. Once the script is done extracting the backup and gives us ownership of the file, we should be able to read the files within.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_symlink_3.png" alt="Example" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_symlink_4.png" alt="Example" /></p><p>Symlink behaviour is often ignored by default depending on the application; so this can partly rely on a little bit of a misconfiguration too. However it’s still worth trying to determine if it is possible to cause a SUID file to behave in an unintended way by abusing them. This type of attack can work for writing and executing files too.</p><h2 id="exploiting-suidguidsudo-with-wildcards">Exploiting SUID/GUID/Sudo with Wildcards</h2><p>So we’ve found a SUID executable, a cronjob that runs as root, or a script we have sudo permissions to run. We don’t have write access to it. We can’t inject commands using it. Binary paths are all properly configured. But we notice that the command being ran has an asterix <code class="language-plaintext highlighter-rouge">*</code> present in an argument and that we can add files to the directory this asterix is being used in.</p><p>Due to the way the shell expands the asterix, we can actually use this to inject arguments. While this isn’t a guaranteed way to escalate privileges, if we’re lucky the binary being called has an argument that allows us code execution.</p><h3 id="wildcard-injection-example-ls">Wildcard Injection Example (ls)</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_wildcard_1.png" alt="Example" /></p><p>Here is an example, note that when I call <code class="language-plaintext highlighter-rouge">ls *</code> when the directory contains only the file <em>blah</em>, I get the normal expected output. Yet when I add a file with the filename of an argument for ls (<code class="language-plaintext highlighter-rouge">-la</code>) the file gets interpreted as an argument. This is the basis of wildcard injection.</p><h3 id="wildcard-injection-example-binary-calling-tar">Wildcard Injection Example (binary calling tar)</h3><p>Now let’s try with a SUID binary. I’ve provided the source code here.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_wildcard_2.png" alt="Example" /></p><p>If we don’t have access to the source code, we can use <em>strings</em> or some reverse engineering to see if we can find anything that looks like a shell command.</p><p>To exploit this we can use the same technique as earlier, this way we can actually cause code execution. This is because tar has an argument <code class="language-plaintext highlighter-rouge">--checkpoint-action=exec=yourcodehere</code> that will run a command you supply after it reaches a certain checkpoint.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_wildcard_3.png" alt="Example" /></p><p>I put in a quick python reverse shell in <em>rs.sh</em>, set up my listener with netcat and then run the binary. In my other terminal,I can see I recieved a root shell!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_wildcard_4.png" alt="Example" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/suid_wildcard_5.png" alt="Example" /></p><p>More Info: <a href="https://www.exploit-db.com/papers/33930/">Unix Wildcards gone Wild</a></p><h2 id="exploiting-file-capabilities">Exploiting File Capabilities</h2><p>Following on from what we now know about SUID/GUID files on Linux, we can see how enabling a file to have one of those bits provides a <strong>lot</strong> of power, and so we need to carefully consider where we use this feature. If a file has a SUID bit to run as root, it has the power to do everything that root can.</p><p>So you may be thinking something along the lines of this; my script/program <em>needs</em> root to do something specific that can’t be fixed by adding it to a group and giving it appropriate file permissions. What if I need to bind to a port under 1024 or set the system time? Do I really need to have to grant my script root privileges, allowing it to do <em>anything</em> if it were to be exploited?</p><p>Well the answer is no. Over the past few years work has been implemented within the kernel to try to break down the need to run something as a fully privileged process. This feature is called <a href="http://man7.org/linux/man-pages/man7/capabilities.7.html">Capabilities</a>.</p><p>Think of your smartphone, unless you’re a luddite, amish or Richard Stallman*. When you install an application from the App/Play store, you’re granted a list of permissions before installing it. You may even be prompted when you’re using it for some specific intrusive permission, such as location detection.</p><p>This is a little bit like what capabilities are for. Rather than granting a file full root privileges when ran with a SUID bit or sudo, we can instead give it specific powers.</p><p>So following on from an example earlier, I want to bind a program, let’s imagine it’s some janky custom webapp I’ve created to a port under 1024, in this case it would likely be 80. My choices are:</p><ol><li>Run this program as root to bind the port correctly.</li><li>Use the <code class="language-plaintext highlighter-rouge">CAP_NET_BIND_SERVICE</code> capability to grant the specific ability to bind to the port, while not providing any other root powers.</li></ol><p>So let’s play with an example. I’ll call Python’s inbuilt SimpleHTTPServer on port 80.</p><p>When I run that with my non root user though, we get a permission denied error. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap1.png" alt="Example" /></p><p>To add the capability to bind to this port, use the following command. You of course need root permissions for this.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">setcap <span class="nv">cap_net_bind_service</span><span class="o">=</span>+ep filename</code></pre></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap2.png" alt="Example" /></p><p>As we can see, we can now bind to port 80 successfully.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap3.png" alt="Example" /></p><p>And use the following command to view capabilities.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">getcap filename</code></pre></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap4.png" alt="Example" /></p><p>Now that we understand what capabilities are, how can we use them to our advantage?</p><p>Exploiting programs with capabilities should be the same thought process as that of SUID executables, except it’s a little more tricky as we’re limited in what we can do.</p><p>I recommended checking if the file you’re exploiting first has capabilities with <code class="language-plaintext highlighter-rouge">getcap</code>, and then checking the link above for what that capability is. If you’re lucky with which capabilities are present, and the program is designed in a way where you can exploit that somehow, you might have a path to privilege escalation.</p><p>*I joke I love you <a href="https://rms.sexy/">Richard</a></p><h3 id="example-3">Example.</h3><p>The <code class="language-plaintext highlighter-rouge">CAP_DAC_OVERRIDE</code> capability bypasses file r/w/x permission checks. If a program has this capability enabled, we can essentially read/write/execute any file when it is ran.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap5.png" alt="Example" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap6.png" alt="Example" /></p><p>Take a look at the above script. This is used to backup a user’s work to another location. Currently (without capabilities) it can’t overwrite a file <em>cant_overwrite_me</em> that is owned by root. (I know the error says segmentation fault but that’s because I’m too lazy to handle errors properly, trust me it’s permissions!)</p><p>Now let’s assume we found the same script but it has the <code class="language-plaintext highlighter-rouge">CAP_DAC_OVERRIDE</code> capability added, maybe a sysadmin enabled it without proper consideration to allow the user to backup to a location that they don’t have write access to. Can you see how we might exploit it to gain privs?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://mil0.io/assets/images/posts/linux_file_perms/cap7.png" alt="Example" /></p><p>We essentially have write access to anywhere on the machine. We can do any number of nasty things with this, including adding a user to <em>/etc/passwd</em> by overwriting it, or adding an SSH key to <em>/etc/ssh</em>.</p><p>Hopefully this can come in useful for you, while usage of capabilities seems to be much rarer than SUID/GUID, it’s still a useful technique to keep in mind.</p><h2 id="exploiting-cron-jobs">Exploiting Cron Jobs</h2><p>If we can find any cron jobs that run as another user/root we may be able to escalate privileges through a misconfiguration</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cat</span> /etc/<span class="k">*</span>cron<span class="k">*</span></code></pre></figure><p>If we have write access to a file run in one of these cron jobs, we can simply inject whatever code we want and escalate. We may have to try some of the methods just discussed.</p><h2 id="exploiting-programs-running-with-higher-privileges">Exploiting programs running with higher privileges.</h2><p>When you get some form of access to a box, you should enumerate what is currently running, but particularly what’s running with higher privileges than you.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">ps aux | <span class="nb">grep </span>root</code></pre></figure><p>If we’re able to exploit one of these services running as root we can gain root ourselves.</p><p>Search online for applicable exploits for the version of software, or common misconfigurations. This next bit might sound a little weird; try checking StackOverflow on how to configure x software (particularly around configuring security related stuff e.g. authorization, backups), and then reading the bad advice a downvoted/low point post can give. This can be a decent way to understand how that software might be likely to be misconfigured.</p><p>If you’re unable to find what version the software is from enumerating it on the file system, the package manager of the box will probably tell you.</p><p>Ubuntu</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt list <span class="nt">--installed</span></code></pre></figure><p>Debian (and ubuntu)</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">dpkg <span class="nt">-l</span></code></pre></figure><p>Centos/RH</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt list <span class="nt">--installed</span></code></pre></figure><h2 id="bound-network-ports">Bound network ports</h2><p>When you get some form of a shell/RCE on a machine you should check which ports are bound internally. These ports on localhost may be different than those exposed to the outside.</p><p>Enumerate all of these services. Grab banners with netcat if it’s possible. If it seems like a HTTP based service, you can quickly check it with curl. Even tunnel out the port to your attacking machine with SSH to take a better look at it if needs be. A lot of more “sensitive” services may be likely to only be visible internally on a machine (think databases, administration panels and so on)</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">netstat <span class="nt">-l</span></code></pre></figure><h2 id="plaintext-credentials">Plaintext credentials</h2><p>Keep an eye out for plaintext creds scattered across the box. Good places to look for are in configuration files <em>(.xml,.cfg,.ini etc)</em>. Check common places for these, if permissions are set incorrectly you may be able to view sensitive config files with a lower privileged user than intended. Database credentials can be a common find especially with home grown apps.</p><h2 id="moving-laterally">Moving laterally</h2><p>If you’re unable to escalate to root with the current account you’re on consider instead seeing if there’s any other users you can escalate to first. Sometimes you need to move sideways before you can move up. This seems to be quite a common step people miss trying when I’m helping them with a CTF. You could spend an hour banging your head trying to gain root in crazy overcomplicated ways only to find that if you had enumerated another user properly too you could have seen that they could just sudo to root without a password because of a dumb misconfiguration/bad practice.</p><p>To view other users check the passwd file. A quick way if you’re unsure which users are non-default is to check to see if there’s a shell enabled at the end of the line. (e.g <code class="language-plaintext highlighter-rouge">/bin/bash</code>,<code class="language-plaintext highlighter-rouge">/bin/sh/</code>,<code class="language-plaintext highlighter-rouge">python</code> etc), though this isn’t always true so don’t rely on it 100%.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cat</span> /etc/passwd</code></pre></figure><h2 id="scripting">Scripting</h2><p>These are very useful for quick enumeration, but they are also pretty noisy and you can become reliant on them. Use them if they help, but don’t let them replace your knowledge on how to do things manually.</p><p><a href="http://www.securitysift.com/download/linuxprivchecker.py">LinuxPrivChecker.py</a></p><p><a href="https://github.com/rebootuser/LinEnum">LinEnum.sh</a></p><h2 id="the-og-guide">The OG guide</h2><p>https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</p><h2 id="the-end">The End</h2><p>Hopefully some of this post has been useful for you. I may update it over time (I’ll add a last edited). Feedback welcomed, especially if I’ve gotten something wrong!</p><p>Last Edited: 17/09/18</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tutorials/'>tutorials</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"></ul></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Crystal-Alpine/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 1, 2020 <i class="unloaded">2020-10-01T01:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Lightweight Crystal Docker images</h3><div class="text-muted small"><p> I’ve recently been writing a few scripts/applications of varying sizes and where possible I’ve been doing so with Crystal. If you aren’t familar with Crystal it’s a relatively new object-orienta...</p></div></div></a></div><div class="card"> <a href="/shodan-crystal/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 19, 2020 <i class="unloaded">2020-08-19T01:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shodan SDK release</h3><div class="text-muted small"><p> I recently had a go at developing a Shodan library for the Crystal programming language. John Matherly of Shodan fame was kind enough to try this out and mentioned it on the Shodan blog. You can ...</p></div></div></a></div><div class="card"> <a href="/oscp/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 20, 2018 <i class="unloaded">2018-08-20T13:33:27+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OSCP Review</h3><div class="text-muted small"><p> Signing up I finished up the last of my university submissions, then took a week off to let my brain rest. I signed up to the PWK course with 90 days of lab time. My course start time was about ...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/oscp/" class="btn btn-outline-primary"><p>OSCP Review</p></a> <a href="/shodan-crystal/" class="btn btn-outline-primary"><p>Shodan SDK release</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/mil0sec">mil0sec</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mil0.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
